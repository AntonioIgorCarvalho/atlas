{"ast":null,"code":"import _slicedToArray from\"/Users/leonardogomes/Documents/atlas/atlas/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useRef,useEffect}from'react';import mapboxgl from'mapbox-gl';import useMap from'@hook/useMap';import useDistrictLayer from'./hook/useDistrictLayer';import useStateLayer from'./hook/useStateLayer';import{accessToken}from'./const';import'./styles.css';import{jsx as _jsx}from\"react/jsx-runtime\";var Map=function Map(){mapboxgl.accessToken=accessToken;var mapContainer=useRef();var _useDistrictLayer=useDistrictLayer(),districtReference=_useDistrictLayer.districtReference,setDistrictReference=_useDistrictLayer.setDistrictReference;var _useStateLayer=useStateLayer(),stateReference=_useStateLayer.stateReference,setStateReference=_useStateLayer.setStateReference;var _useMap=useMap(),resetMapValues=_useMap.resetMapValues,resetDistrictValues=_useMap.resetDistrictValues;var _useState=useState(),_useState2=_slicedToArray(_useState,2),map=_useState2[0],setMap=_useState2[1];useEffect(function(){var initializeMap=function initializeMap(ref){var center=[-58,-15];var mapReference=new mapboxgl.Map({container:ref.current,style:'mapbox://styles/mapbox/dark-v10',center:center,zoom:3.4});mapReference.on('click',function(e){var bbox=[[e.point.x-5,e.point.y-5],[e.point.x+5,e.point.y+5]];//@ts-ignore\nvar clickedDistrict=mapReference.queryRenderedFeatures(bbox,{layers:['fill-district']});var zoom=mapReference.getZoom();if(clickedDistrict.length===0&&zoom>6){resetDistrictValues();}else if(clickedDistrict.length===0){resetMapValues();}});setMap(mapReference);};if(!map){initializeMap(mapContainer);}else{if(!districtReference){setDistrictReference(map);}if(!stateReference){setStateReference(map);}}},[map]);return/*#__PURE__*/_jsx(\"div\",{id:\"map\",ref:function ref(el){return mapContainer.current=el;},className:\"map\"});};export default Map;","map":{"version":3,"names":["React","useState","useRef","useEffect","mapboxgl","useMap","useDistrictLayer","useStateLayer","accessToken","Map","mapContainer","districtReference","setDistrictReference","stateReference","setStateReference","resetMapValues","resetDistrictValues","map","setMap","initializeMap","ref","center","mapReference","container","current","style","zoom","on","e","bbox","point","x","y","clickedDistrict","queryRenderedFeatures","layers","getZoom","length","el"],"sources":["/Users/leonardogomes/Documents/atlas/atlas/src/components/Map/Map.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport mapboxgl from 'mapbox-gl';\n\nimport useMap from '@hook/useMap';\n\nimport useDistrictLayer from './hook/useDistrictLayer';\nimport useStateLayer from './hook/useStateLayer';\n\nimport { accessToken } from './const';\n\nimport './styles.css';\n\nconst Map = () => {\n  mapboxgl.accessToken = accessToken;\n\n  const mapContainer = useRef<any>();\n\n  const { districtReference, setDistrictReference } = useDistrictLayer();\n  const { stateReference, setStateReference } = useStateLayer();\n\n  const { resetMapValues, resetDistrictValues } = useMap();\n  const [map, setMap] = useState<mapboxgl.Map>();\n\n  useEffect(() => {\n    const initializeMap = (ref: any) => {\n      const center: mapboxgl.LngLatLike = [-58, -15];\n\n      const mapReference = new mapboxgl.Map({\n        container: ref.current,\n        style: 'mapbox://styles/mapbox/dark-v10',\n        center: center,\n        zoom: 3.4,\n      });\n\n      mapReference.on('click', (e) => {\n        const bbox = [\n          [e.point.x - 5, e.point.y - 5],\n          [e.point.x + 5, e.point.y + 5],\n        ];\n\n        //@ts-ignore\n        const clickedDistrict = mapReference.queryRenderedFeatures(bbox, {\n          layers: ['fill-district'],\n        });\n\n        const zoom = mapReference.getZoom();\n\n        if (clickedDistrict.length === 0 && zoom > 6) {\n          resetDistrictValues();\n        } else if (clickedDistrict.length === 0) {\n          resetMapValues();\n        }\n      });\n\n      setMap(mapReference);\n    };\n\n    if (!map) {\n      initializeMap(mapContainer);\n    } else {\n      if (!districtReference) {\n        setDistrictReference(map);\n      }\n\n      if (!stateReference) {\n        setStateReference(map);\n      }\n    }\n  }, [map]);\n\n  return <div id=\"map\" ref={(el) => (mapContainer.current = el)} className=\"map\" />;\n};\n\nexport default Map;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}