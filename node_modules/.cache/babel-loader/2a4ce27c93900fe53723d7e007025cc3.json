{"ast":null,"code":"var _jsxFileName = \"/Users/leonardogomes/Documents/atlas/atlas/src/components/Map/hook/useStateLayer/stateActions.tsx\";\nimport React from 'react';\nimport * as turf from '@turf/turf';\nimport ReactDOM from 'react-dom';\nimport { clickedPopup, hoveredPopup } from '../../const';\nimport { ClickablePopup } from '@components/Map/components';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nlet hoveredId;\nlet clickedId;\n\nfunction addClickPopup(event, map) {\n  var _feature$properties, _feature$properties2, _feature$properties3;\n\n  const coordinates = event.lngLat;\n  const feature = event.features[0];\n  const regionName = feature === null || feature === void 0 ? void 0 : (_feature$properties = feature.properties) === null || _feature$properties === void 0 ? void 0 : _feature$properties.NM_UF;\n  const placeholder = document.createElement('div');\n  const population = (feature === null || feature === void 0 ? void 0 : (_feature$properties2 = feature.properties) === null || _feature$properties2 === void 0 ? void 0 : _feature$properties2.CD_UF) != undefined ? geosesData[feature === null || feature === void 0 ? void 0 : (_feature$properties3 = feature.properties) === null || _feature$properties3 === void 0 ? void 0 : _feature$properties3.CD_UFD]['Populacao_Estimada'] : '';\n\n  if (regionName) {\n    ReactDOM.render( /*#__PURE__*/_jsxDEV(ClickablePopup, {\n      regionName: regionName,\n      reference: map,\n      feature: feature\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 26,\n      columnNumber: 21\n    }, this), placeholder);\n    clickedPopup.setLngLat([coordinates[0], coordinates[1]]).setDOMContent(placeholder).addTo(map);\n  }\n}\n\nfunction addPopup(feature, map, type) {\n  var _feature$properties4;\n\n  const regionName = feature === null || feature === void 0 ? void 0 : (_feature$properties4 = feature.properties) === null || _feature$properties4 === void 0 ? void 0 : _feature$properties4.NM_UF;\n  const coordinates = turf.centerOfMass(feature).geometry.coordinates;\n  const placeholder = document.createElement('div');\n\n  switch (type) {\n    case 'hover':\n      hoveredPopup.trackPointer().setHTML(`<h5>${regionName}</h5>`).addTo(map);\n      break;\n\n    case 'click':\n      if (regionName) {\n        ReactDOM.render( /*#__PURE__*/_jsxDEV(ClickablePopup, {\n          regionName: regionName,\n          reference: map,\n          feature: feature\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 44,\n          columnNumber: 25\n        }, this), placeholder);\n        clickedPopup.setLngLat([coordinates[0], coordinates[1]]).setDOMContent(placeholder).addTo(map);\n      }\n\n      break;\n  }\n}\n\nfunction setFeatureHover(featureID, map, state) {\n  map.setFeatureState({\n    source: 'state',\n    id: featureID\n  }, {\n    hover: state\n  });\n}\n\nfunction setFeatureClick(featureID, map, state) {\n  map.setFeatureState({\n    source: 'state',\n    id: featureID\n  }, {\n    hover: state\n  });\n}\n\nexport function clickState(feature, map) {\n  var _feature$properties5;\n\n  const stateID = feature === null || feature === void 0 ? void 0 : (_feature$properties5 = feature.properties) === null || _feature$properties5 === void 0 ? void 0 : _feature$properties5.CD_UF;\n\n  if (feature && feature.geometry) {\n    if (stateID === clickedId) {\n      return;\n    }\n\n    addPopup(feature, map, 'click');\n\n    if (clickedId) {\n      setFeatureClick(clickedId, map, false);\n    }\n\n    if (stateID) {\n      setFeatureClick(stateID, map, true);\n      clickedId = stateID;\n    }\n  } else if (clickedId) {\n    if (map.getSource('state')) {\n      setFeatureClick(clickedId, map, false);\n    }\n\n    clickedId = undefined;\n  }\n}\nexport function highlightState(feature, map) {\n  var _feature$properties6;\n\n  const stateID = feature === null || feature === void 0 ? void 0 : (_feature$properties6 = feature.properties) === null || _feature$properties6 === void 0 ? void 0 : _feature$properties6.CD_UF;\n\n  if (feature && feature.geometry) {\n    if (stateID === hoveredId) {\n      return;\n    }\n\n    addPopup(feature, map, 'hover');\n\n    if (hoveredId) {\n      setFeatureHover(hoveredId, map, false);\n    }\n\n    if (stateID) {\n      setFeatureHover(stateID, map, true);\n      hoveredId = stateID;\n    }\n  } else if (hoveredId) {\n    hoveredPopup.remove();\n\n    if (map.getSource('state')) {\n      setFeatureHover(hoveredId, map, false);\n    }\n\n    hoveredId = undefined;\n  }\n}\nexport function isStateLayerVisible(map, visible) {\n  const visibility = visible ? 'visible' : 'none';\n\n  if (map.getLayer('fill-state')) {\n    map.setLayoutProperty('fill-state', 'visibility', visibility);\n  }\n\n  if (map.getLayer('state-borders')) {\n    map.setLayoutProperty('state-borders', 'visibility', visibility);\n  }\n}\nexport function cleanStateActions() {\n  hoveredPopup.remove();\n  clickedPopup.remove();\n  clickedId = 0;\n  hoveredId = undefined;\n}\nexport function fitStateBounds(feature, map) {\n  if (feature && (feature.geometry || feature._geometry)) {\n    const [minX, minY, maxX, maxY] = turf.bbox(feature);\n    map.fitBounds([[minX, minY], [maxX, maxY]], {\n      padding: {\n        top: 100,\n        bottom: 100,\n        left: 200,\n        right: 200\n      }\n    });\n  }\n}\nexport function fitStateCenter(feature, map) {\n  if (feature && (feature.geometry || feature._geometry)) {\n    const [minX, minY, maxX, maxY] = turf.bbox(feature);\n    const coordinates = turf.centerOfMass(feature).geometry.coordinates;\n    map.flyTo({\n      center: [coordinates[0], coordinates[1]]\n    });\n  }\n}","map":{"version":3,"names":["React","turf","ReactDOM","clickedPopup","hoveredPopup","ClickablePopup","hoveredId","clickedId","addClickPopup","event","map","coordinates","lngLat","feature","features","regionName","properties","NM_UF","placeholder","document","createElement","population","CD_UF","undefined","geosesData","CD_UFD","render","setLngLat","setDOMContent","addTo","addPopup","type","centerOfMass","geometry","trackPointer","setHTML","setFeatureHover","featureID","state","setFeatureState","source","id","hover","setFeatureClick","clickState","stateID","getSource","highlightState","remove","isStateLayerVisible","visible","visibility","getLayer","setLayoutProperty","cleanStateActions","fitStateBounds","_geometry","minX","minY","maxX","maxY","bbox","fitBounds","padding","top","bottom","left","right","fitStateCenter","flyTo","center"],"sources":["/Users/leonardogomes/Documents/atlas/atlas/src/components/Map/hook/useStateLayer/stateActions.tsx"],"sourcesContent":["import React from 'react';\nimport * as turf from '@turf/turf';\nimport mapboxgl from 'mapbox-gl';\nimport ReactDOM from 'react-dom';\n\nimport { State } from '@customTypes/feature';\n\nimport { clickedPopup, hoveredPopup } from '../../const';\nimport { ClickablePopup } from '@components/Map/components';\n\nlet hoveredId: number | undefined;\nlet clickedId: number | undefined;\n\ntype Feature = State | null;\n\nfunction addClickPopup(event: mapboxgl.EventData, map: mapboxgl.Map) {\n  const coordinates = event.lngLat;\n  const feature: Feature = event.features[0];\n\n  const regionName = feature?.properties?.NM_UF;\n  const placeholder = document.createElement('div');\n  const population =\n    feature?.properties?.CD_UF != undefined ? geosesData[feature?.properties?.CD_UFD]['Populacao_Estimada'] : '';\n\n  if (regionName) {\n    ReactDOM.render(<ClickablePopup regionName={regionName} reference={map} feature={feature} />, placeholder);\n\n    clickedPopup.setLngLat([coordinates[0], coordinates[1]]).setDOMContent(placeholder).addTo(map);\n  }\n}\n\nfunction addPopup(feature: Feature, map: mapboxgl.Map, type: string) {\n  const regionName = feature?.properties?.NM_UF;\n  const coordinates = turf.centerOfMass(feature).geometry.coordinates;\n  const placeholder = document.createElement('div');\n\n  switch (type) {\n    case 'hover':\n      hoveredPopup.trackPointer().setHTML(`<h5>${regionName}</h5>`).addTo(map);\n\n      break;\n    case 'click':\n      if (regionName) {\n        ReactDOM.render(<ClickablePopup regionName={regionName} reference={map} feature={feature} />, placeholder);\n\n        clickedPopup.setLngLat([coordinates[0], coordinates[1]]).setDOMContent(placeholder).addTo(map);\n      }\n\n      break;\n  }\n}\n\nfunction setFeatureHover(featureID: number, map: mapboxgl.Map, state: boolean) {\n  map.setFeatureState({ source: 'state', id: featureID }, { hover: state });\n}\n\nfunction setFeatureClick(featureID: number, map: mapboxgl.Map, state: boolean) {\n  map.setFeatureState({ source: 'state', id: featureID }, { hover: state });\n}\n\nexport function clickState(feature: Feature, map: mapboxgl.Map) {\n  const stateID = feature?.properties?.CD_UF;\n\n  if (feature && feature.geometry) {\n    if (stateID === clickedId) {\n      return;\n    }\n    addPopup(feature, map, 'click');\n\n    if (clickedId) {\n      setFeatureClick(clickedId, map, false);\n    }\n\n    if (stateID) {\n      setFeatureClick(stateID, map, true);\n      clickedId = stateID;\n    }\n  } else if (clickedId) {\n    if (map.getSource('state')) {\n      setFeatureClick(clickedId, map, false);\n    }\n    clickedId = undefined;\n  }\n}\n\nexport function highlightState(feature: Feature, map: mapboxgl.Map) {\n  const stateID = feature?.properties?.CD_UF;\n\n  if (feature && feature.geometry) {\n    if (stateID === hoveredId) {\n      return;\n    }\n\n    addPopup(feature, map, 'hover');\n\n    if (hoveredId) {\n      setFeatureHover(hoveredId, map, false);\n    }\n\n    if (stateID) {\n      setFeatureHover(stateID, map, true);\n      hoveredId = stateID;\n    }\n  } else if (hoveredId) {\n    hoveredPopup.remove();\n\n    if (map.getSource('state')) {\n      setFeatureHover(hoveredId, map, false);\n    }\n    hoveredId = undefined;\n  }\n}\n\nexport function isStateLayerVisible(map: mapboxgl.Map, visible: boolean) {\n  const visibility = visible ? 'visible' : 'none';\n\n  if (map.getLayer('fill-state')) {\n    map.setLayoutProperty('fill-state', 'visibility', visibility);\n  }\n\n  if (map.getLayer('state-borders')) {\n    map.setLayoutProperty('state-borders', 'visibility', visibility);\n  }\n}\n\nexport function cleanStateActions() {\n  hoveredPopup.remove();\n  clickedPopup.remove();\n  clickedId = 0;\n  hoveredId = undefined;\n}\n\nexport function fitStateBounds(feature: Feature, map: mapboxgl.Map) {\n  if (feature && (feature.geometry || feature._geometry)) {\n    const [minX, minY, maxX, maxY] = turf.bbox(feature);\n\n    map.fitBounds(\n      [\n        [minX, minY],\n        [maxX, maxY],\n      ],\n      {\n        padding: { top: 100, bottom: 100, left: 200, right: 200 },\n      },\n    );\n  }\n}\n\nexport function fitStateCenter(feature: Feature, map: mapboxgl.Map) {\n  if (feature && (feature.geometry || feature._geometry)) {\n    const [minX, minY, maxX, maxY] = turf.bbox(feature);\n    const coordinates = turf.centerOfMass(feature).geometry.coordinates;\n\n    map.flyTo({\n      center: [coordinates[0], coordinates[1]],\n    });\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}