{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useEffect, useState } from 'react';\nimport geojsonURL from '@data/BR_UF_2020.json';\nimport { useSelectedState } from '@store/state/selectedContext';\nimport { useHighlightedState } from '@store/state/highlightedContext';\nimport { highlightState, clickState, isStateLayerVisible, cleanStateActions, fitStateCenter } from './stateActions';\nimport { fitCenter } from '../../actions';\nimport { stateColors } from './const';\nimport { lineOpacity, lineWidth, fillOpacity } from '../../const';\nimport { isDistrictLayerVisible } from '../useDistrictLayer/districtActions';\n\nconst useStateLayer = () => {\n  _s();\n\n  const [stateReference, setStateReference] = useState();\n  const {\n    setHighlighted: setHighlightedState,\n    highlighted: highlightedState\n  } = useHighlightedState();\n  const {\n    setSelected: setSelectedState,\n    selected: selectedState\n  } = useSelectedState();\n\n  function initLayers(reference) {\n    reference.on('load', () => {\n      reference.addSource('state', {\n        type: 'geojson',\n        //@ts-ignore\n        data: geojsonURL,\n        //@ts-ignore\n        promoteId: 'CD_UF'\n      });\n      reference.addLayer({\n        id: 'fill-state',\n        type: 'fill',\n        source: 'state',\n        layout: {\n          visibility: 'visible'\n        },\n        paint: {\n          'fill-color': {\n            property: 'POPULATION',\n            stops: stateColors\n          },\n          //@ts-ignore\n          'fill-opacity': fillOpacity\n        }\n      });\n      reference.addLayer({\n        id: 'state-borders',\n        type: 'line',\n        source: 'state',\n        layout: {\n          visibility: 'visible'\n        },\n        paint: {\n          'line-color': '#ffffff',\n          //@ts-ignore\n          'line-width': lineWidth,\n          //@ts-ignore\n          'line-opacity': lineOpacity\n        }\n      });\n    });\n  }\n\n  function initActions(reference) {\n    reference.on('click', 'fill-state', e => {\n      if (e.features.length > 0) {\n        setSelectedState(e.features[0]);\n      }\n\n      addClickPopup(e, reference);\n    });\n    reference.on('mousemove', 'fill-state', e => {\n      if (e.features.length > 0) {\n        setHighlightedState(e.features[0]);\n      }\n    });\n    reference.on('mouseleave', 'fill-state', () => {\n      setHighlightedState(null);\n    });\n  }\n\n  useEffect(() => {\n    if (stateReference) {\n      initLayers(stateReference);\n      initActions(stateReference);\n    }\n  }, [stateReference]);\n  useEffect(() => {\n    if (stateReference) {\n      highlightState(highlightedState, stateReference);\n    }\n  }, [highlightedState]);\n  useEffect(() => {\n    if (stateReference && selectedState !== null) {\n      clickState(selectedState, stateReference);\n      fitStateCenter(selectedState, stateReference);\n    } else if (stateReference) {\n      clickState(null, stateReference);\n      fitCenter(stateReference);\n      isDistrictLayerVisible(stateReference, false);\n      isStateLayerVisible(stateReference, true);\n      cleanStateActions();\n    }\n  }, [selectedState, stateReference]);\n  return {\n    initLayers,\n    initActions,\n    setStateReference,\n    stateReference\n  };\n};\n\n_s(useStateLayer, \"TVa5rsRDST1LadOGel7tuVvKgww=\", false, function () {\n  return [useHighlightedState, useSelectedState];\n});\n\nexport default useStateLayer;","map":{"version":3,"names":["useEffect","useState","geojsonURL","useSelectedState","useHighlightedState","highlightState","clickState","isStateLayerVisible","cleanStateActions","fitStateCenter","fitCenter","stateColors","lineOpacity","lineWidth","fillOpacity","isDistrictLayerVisible","useStateLayer","stateReference","setStateReference","setHighlighted","setHighlightedState","highlighted","highlightedState","setSelected","setSelectedState","selected","selectedState","initLayers","reference","on","addSource","type","data","promoteId","addLayer","id","source","layout","visibility","paint","property","stops","initActions","e","features","length","addClickPopup"],"sources":["/Users/leonardogomes/Documents/atlas/atlas/src/components/Map/hook/useStateLayer/useStateLayer.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\n\nimport mapboxgl from 'mapbox-gl';\n\nimport geojsonURL from '@data/BR_UF_2020.json';\n\nimport { useSelectedState } from '@store/state/selectedContext';\nimport { useHighlightedState } from '@store/state/highlightedContext';\n\nimport { highlightState, clickState, isStateLayerVisible, cleanStateActions, fitStateCenter } from './stateActions';\n\nimport { fitCenter } from '../../actions';\nimport { stateColors } from './const';\nimport { lineOpacity, lineWidth, fillOpacity } from '../../const';\nimport { isDistrictLayerVisible } from '../useDistrictLayer/districtActions';\n\nconst useStateLayer = () => {\n  const [stateReference, setStateReference] = useState<mapboxgl.Map>();\n\n  const { setHighlighted: setHighlightedState, highlighted: highlightedState } = useHighlightedState();\n  const { setSelected: setSelectedState, selected: selectedState } = useSelectedState();\n\n  function initLayers(reference: mapboxgl.Map) {\n    reference.on('load', () => {\n      reference.addSource('state', {\n        type: 'geojson',\n        //@ts-ignore\n        data: geojsonURL,\n        //@ts-ignore\n        promoteId: 'CD_UF',\n      });\n\n      reference.addLayer({\n        id: 'fill-state',\n        type: 'fill',\n        source: 'state',\n        layout: {\n          visibility: 'visible',\n        },\n        paint: {\n          'fill-color': {\n            property: 'POPULATION',\n            stops: stateColors,\n          },\n          //@ts-ignore\n          'fill-opacity': fillOpacity,\n        },\n      });\n\n      reference.addLayer({\n        id: 'state-borders',\n        type: 'line',\n        source: 'state',\n        layout: {\n          visibility: 'visible',\n        },\n        paint: {\n          'line-color': '#ffffff',\n          //@ts-ignore\n          'line-width': lineWidth,\n          //@ts-ignore\n          'line-opacity': lineOpacity,\n        },\n      });\n    });\n  }\n\n  function initActions(reference: mapboxgl.Map) {\n    reference.on('click', 'fill-state', (e: any) => {\n      if (e.features.length > 0) {\n        setSelectedState(e.features[0]);\n      }\n\n      addClickPopup(e, reference);\n    });\n\n    reference.on('mousemove', 'fill-state', (e: any) => {\n      if (e.features.length > 0) {\n        setHighlightedState(e.features[0]);\n      }\n    });\n\n    reference.on('mouseleave', 'fill-state', () => {\n      setHighlightedState(null);\n    });\n  }\n\n  useEffect(() => {\n    if (stateReference) {\n      initLayers(stateReference);\n      initActions(stateReference);\n    }\n  }, [stateReference]);\n\n  useEffect(() => {\n    if (stateReference) {\n      highlightState(highlightedState, stateReference);\n    }\n  }, [highlightedState]);\n\n  useEffect(() => {\n    if (stateReference && selectedState !== null) {\n      clickState(selectedState, stateReference);\n\n      fitStateCenter(selectedState, stateReference);\n    } else if (stateReference) {\n      clickState(null, stateReference);\n\n      fitCenter(stateReference);\n\n      isDistrictLayerVisible(stateReference, false);\n      isStateLayerVisible(stateReference, true);\n\n      cleanStateActions();\n    }\n  }, [selectedState, stateReference]);\n\n  return {\n    initLayers,\n    initActions,\n    setStateReference,\n    stateReference,\n  };\n};\n\nexport default useStateLayer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}