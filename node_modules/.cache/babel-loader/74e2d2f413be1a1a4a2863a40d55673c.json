{"ast":null,"code":"import _objectSpread from\"/Users/leonardogomes/Documents/atlas/atlas/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useRef}from'react';import{useCombobox}from'downshift';import useMap from'@hook/useMap';import{useHighlightedDistrict}from'@store/district/highlightedContext';import{useSelectedDistrict}from'@store/district/selectedContext';var useSearch=function useSearch(featureSearched){var _selected$properties$;var inputRef=useRef(null);var _useSelectedDistrict=useSelectedDistrict(),selected=_useSelectedDistrict.selected,setSelected=_useSelectedDistrict.setSelected;var _useHighlightedDistri=useHighlightedDistrict(),setHighlighted=_useHighlightedDistri.setHighlighted;var _useMap=useMap(),resetMapValues=_useMap.resetMapValues;var initialInputValue=(_selected$properties$=selected===null||selected===void 0?void 0:selected.properties.NM_MUN)!==null&&_selected$properties$!==void 0?_selected$properties$:'';var itemToString=function itemToString(item){return item?item.name:'';};var onSelectedItemChange=function onSelectedItemChange(item){return setSelected(item.selectedItem);};var _useCombobox=useCombobox({defaultHighlightedIndex:0,initialInputValue:initialInputValue,items:featureSearched,itemToString:itemToString,onSelectedItemChange:onSelectedItemChange,onInputValueChange:function onInputValueChange(_ref){var input=_ref.inputValue,type=_ref.type;if(input===''&&type===useCombobox.stateChangeTypes.InputChange){resetMapValues();}else if(isOpen&&input!==''){var definiteMatch=featureSearched.find(function(item){return item.properties.NM_MUN===input;});if(definiteMatch){selectItem(definiteMatch);}}},onHighlightedIndexChange:function onHighlightedIndexChange(_ref2){var highlightID=_ref2.highlightedIndex,type=_ref2.type;switch(type){case useCombobox.stateChangeTypes.ItemClick:case useCombobox.stateChangeTypes.InputKeyDownEnter:case useCombobox.stateChangeTypes.FunctionSelectItem:break;default://@ts-ignore\nsetHighlighted(featureSearched[highlightID]);}},stateReducer:function stateReducer(state,actionAndChanges){var type=actionAndChanges.type,changes=actionAndChanges.changes;switch(type){case useCombobox.stateChangeTypes.InputBlur:return _objectSpread(_objectSpread({},changes),{},{//@ts-ignore\ninputValue:initialInputValue,selectedItem:state.selectedItem});default:return changes;}}}),getComboboxProps=_useCombobox.getComboboxProps,getInputProps=_useCombobox.getInputProps,getItemProps=_useCombobox.getItemProps,getMenuProps=_useCombobox.getMenuProps,getToggleButtonProps=_useCombobox.getToggleButtonProps,highlightedIndex=_useCombobox.highlightedIndex,inputValue=_useCombobox.inputValue,isOpen=_useCombobox.isOpen,openMenu=_useCombobox.openMenu,reset=_useCombobox.reset,selectItem=_useCombobox.selectItem,setInputValue=_useCombobox.setInputValue;var cleanSearchBar=function cleanSearchBar(){resetMapValues();reset();};var inputProps=_objectSpread({},getInputProps({onFocus:function onFocus(){if(!isOpen){openMenu();}},placeholder:'Pesquise por regiões',spellCheck:'false',ref:inputRef}));return{getComboboxProps:getComboboxProps,getInputProps:getInputProps,getItemProps:getItemProps,getMenuProps:getMenuProps,getToggleButtonProps:getToggleButtonProps,inputProps:inputProps,highlightedIndex:highlightedIndex,inputValue:inputValue,isOpen:isOpen,openMenu:openMenu,reset:reset,cleanSearchBar:cleanSearchBar,selectItem:selectItem,setInputValue:setInputValue};};useSearch.defaultProps={cfeatureSearched:[]};export default useSearch;","map":{"version":3,"names":["useRef","useCombobox","useMap","useHighlightedDistrict","useSelectedDistrict","useSearch","featureSearched","inputRef","selected","setSelected","setHighlighted","resetMapValues","initialInputValue","properties","NM_MUN","itemToString","item","name","onSelectedItemChange","selectedItem","defaultHighlightedIndex","items","onInputValueChange","input","inputValue","type","stateChangeTypes","InputChange","isOpen","definiteMatch","find","selectItem","onHighlightedIndexChange","highlightID","highlightedIndex","ItemClick","InputKeyDownEnter","FunctionSelectItem","stateReducer","state","actionAndChanges","changes","InputBlur","getComboboxProps","getInputProps","getItemProps","getMenuProps","getToggleButtonProps","openMenu","reset","setInputValue","cleanSearchBar","inputProps","onFocus","placeholder","spellCheck","ref","defaultProps","cfeatureSearched"],"sources":["/Users/leonardogomes/Documents/atlas/atlas/src/components/Header/SearchBar/hook/useSearch.ts"],"sourcesContent":["import { useRef } from 'react';\n\nimport { useCombobox } from 'downshift';\n\nimport useMap from '@hook/useMap';\n\nimport { useHighlightedDistrict } from '@store/district/highlightedContext';\nimport { useSelectedDistrict } from '@store/district/selectedContext';\nimport { District } from '@customTypes/feature';\n\nconst useSearch = (featureSearched: District[]) => {\n  const inputRef = useRef<HTMLInputElement>(null);\n\n  const { selected, setSelected } = useSelectedDistrict();\n  const { setHighlighted } = useHighlightedDistrict();\n  const { resetMapValues } = useMap();\n\n  const initialInputValue = selected?.properties.NM_MUN ?? '';\n\n  const itemToString = (item: any) => (item ? item.name : '');\n\n  const onSelectedItemChange = (item: any) => setSelected(item.selectedItem);\n\n  const {\n    getComboboxProps,\n    getInputProps,\n    getItemProps,\n    getMenuProps,\n    getToggleButtonProps,\n    highlightedIndex,\n    inputValue,\n    isOpen,\n    openMenu,\n    reset,\n    selectItem,\n    setInputValue,\n  } = useCombobox({\n    defaultHighlightedIndex: 0,\n    initialInputValue,\n    items: featureSearched,\n    itemToString,\n    onSelectedItemChange,\n\n    onInputValueChange: ({ inputValue: input, type }) => {\n      if (input === '' && type === useCombobox.stateChangeTypes.InputChange) {\n        resetMapValues();\n      } else if (isOpen && input !== '') {\n        const definiteMatch = featureSearched.find((item) => item.properties.NM_MUN === input);\n\n        if (definiteMatch) {\n          selectItem(definiteMatch);\n        }\n      }\n    },\n\n    onHighlightedIndexChange: ({ highlightedIndex: highlightID, type }) => {\n      switch (type) {\n        case useCombobox.stateChangeTypes.ItemClick:\n        case useCombobox.stateChangeTypes.InputKeyDownEnter:\n        case useCombobox.stateChangeTypes.FunctionSelectItem:\n          break;\n        default:\n          //@ts-ignore\n          setHighlighted(featureSearched[highlightID]);\n      }\n    },\n\n    stateReducer: (state, actionAndChanges) => {\n      const { type, changes } = actionAndChanges;\n      switch (type) {\n        case useCombobox.stateChangeTypes.InputBlur:\n          return {\n            ...changes,\n            //@ts-ignore\n            inputValue: initialInputValue,\n            selectedItem: state.selectedItem,\n          };\n        default:\n          return changes;\n      }\n    },\n  });\n\n  const cleanSearchBar = () => {\n    resetMapValues();\n    reset();\n  };\n\n  const inputProps = {\n    ...getInputProps({\n      onFocus: () => {\n        if (!isOpen) {\n          openMenu();\n        }\n      },\n      placeholder: 'Pesquise por regiões',\n      spellCheck: 'false',\n      ref: inputRef,\n    }),\n  };\n\n  return {\n    getComboboxProps,\n    getInputProps,\n    getItemProps,\n    getMenuProps,\n    getToggleButtonProps,\n    inputProps,\n    highlightedIndex,\n    inputValue,\n    isOpen,\n    openMenu,\n    reset,\n    cleanSearchBar,\n    selectItem,\n    setInputValue,\n  };\n};\n\nuseSearch.defaultProps = {\n  cfeatureSearched: [],\n};\n\nexport default useSearch;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}