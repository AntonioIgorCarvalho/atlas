{"ast":null,"code":"var _jsxFileName = \"/Users/leonardogomes/Documents/atlas/atlas/src/components/Map/Map.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useRef, useEffect } from 'react';\nimport mapboxgl from 'mapbox-gl';\nimport useMap from '@hook/useMap';\nimport useDistrictLayer from './hook/useDistrictLayer';\nimport useStateLayer from './hook/useStateLayer';\nimport { accessToken } from './const';\nimport './styles.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Map = () => {\n  _s();\n\n  mapboxgl.accessToken = accessToken;\n  const mapContainer = useRef();\n  const {\n    districtReference,\n    setDistrictReference\n  } = useDistrictLayer();\n  const {\n    stateReference,\n    setStateReference\n  } = useStateLayer();\n  const {\n    resetMapValues,\n    resetDistrictValues\n  } = useMap();\n  const [map, setMap] = useState();\n  useEffect(() => {\n    const initializeMap = ref => {\n      const center = [-58, -15];\n      const mapReference = new mapboxgl.Map({\n        container: ref.current,\n        style: 'mapbox://styles/mapbox/dark-v10',\n        center: center,\n        zoom: 3.4\n      });\n      mapReference.on('click', e => {\n        const bbox = [[e.point.x - 5, e.point.y - 5], [e.point.x + 5, e.point.y + 5]]; //@ts-ignore\n\n        const clickedDistrict = mapReference.queryRenderedFeatures(bbox, {\n          layers: ['fill-district']\n        });\n        const zoom = mapReference.getZoom();\n\n        if (clickedDistrict.length === 0 && zoom > 6) {\n          resetDistrictValues();\n        } else if (clickedDistrict.length === 0) {\n          resetMapValues();\n        }\n      });\n      setMap(mapReference);\n    };\n\n    if (!map) {\n      initializeMap(mapContainer);\n    } else {\n      if (!districtReference) {\n        setDistrictReference(map);\n      }\n\n      if (!stateReference) {\n        setStateReference(map);\n      }\n    }\n  }, [map]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    id: \"map\",\n    ref: el => mapContainer.current = el,\n    className: \"map\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 71,\n    columnNumber: 10\n  }, this);\n};\n\n_s(Map, \"7tUx42nvpGXjRpDADSEf6x54lQA=\", false, function () {\n  return [useDistrictLayer, useStateLayer, useMap];\n});\n\n_c = Map;\nexport default Map;\n\nvar _c;\n\n$RefreshReg$(_c, \"Map\");","map":{"version":3,"names":["React","useState","useRef","useEffect","mapboxgl","useMap","useDistrictLayer","useStateLayer","accessToken","Map","mapContainer","districtReference","setDistrictReference","stateReference","setStateReference","resetMapValues","resetDistrictValues","map","setMap","initializeMap","ref","center","mapReference","container","current","style","zoom","on","e","bbox","point","x","y","clickedDistrict","queryRenderedFeatures","layers","getZoom","length","el"],"sources":["/Users/leonardogomes/Documents/atlas/atlas/src/components/Map/Map.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport mapboxgl from 'mapbox-gl';\n\nimport useMap from '@hook/useMap';\n\nimport useDistrictLayer from './hook/useDistrictLayer';\nimport useStateLayer from './hook/useStateLayer';\n\nimport { accessToken } from './const';\n\nimport './styles.css';\n\nconst Map = () => {\n  mapboxgl.accessToken = accessToken;\n\n  const mapContainer = useRef<any>();\n\n  const { districtReference, setDistrictReference } = useDistrictLayer();\n  const { stateReference, setStateReference } = useStateLayer();\n\n  const { resetMapValues, resetDistrictValues } = useMap();\n  const [map, setMap] = useState<mapboxgl.Map>();\n\n  useEffect(() => {\n    const initializeMap = (ref: any) => {\n      const center: mapboxgl.LngLatLike = [-58, -15];\n\n      const mapReference = new mapboxgl.Map({\n        container: ref.current,\n        style: 'mapbox://styles/mapbox/dark-v10',\n        center: center,\n        zoom: 3.4,\n      });\n\n      mapReference.on('click', (e) => {\n        const bbox = [\n          [e.point.x - 5, e.point.y - 5],\n          [e.point.x + 5, e.point.y + 5],\n        ];\n\n        //@ts-ignore\n        const clickedDistrict = mapReference.queryRenderedFeatures(bbox, {\n          layers: ['fill-district'],\n        });\n\n        const zoom = mapReference.getZoom();\n\n        if (clickedDistrict.length === 0 && zoom > 6) {\n          resetDistrictValues();\n        } else if (clickedDistrict.length === 0) {\n          resetMapValues();\n        }\n      });\n\n      setMap(mapReference);\n    };\n\n    if (!map) {\n      initializeMap(mapContainer);\n    } else {\n      if (!districtReference) {\n        setDistrictReference(map);\n      }\n\n      if (!stateReference) {\n        setStateReference(map);\n      }\n    }\n  }, [map]);\n\n  return <div id=\"map\" ref={(el) => (mapContainer.current = el)} className=\"map\" />;\n};\n\nexport default Map;\n"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,MAA1B,EAAkCC,SAAlC,QAAmD,OAAnD;AACA,OAAOC,QAAP,MAAqB,WAArB;AAEA,OAAOC,MAAP,MAAmB,cAAnB;AAEA,OAAOC,gBAAP,MAA6B,yBAA7B;AACA,OAAOC,aAAP,MAA0B,sBAA1B;AAEA,SAASC,WAAT,QAA4B,SAA5B;AAEA,OAAO,cAAP;;;AAEA,MAAMC,GAAG,GAAG,MAAM;EAAA;;EAChBL,QAAQ,CAACI,WAAT,GAAuBA,WAAvB;EAEA,MAAME,YAAY,GAAGR,MAAM,EAA3B;EAEA,MAAM;IAAES,iBAAF;IAAqBC;EAArB,IAA8CN,gBAAgB,EAApE;EACA,MAAM;IAAEO,cAAF;IAAkBC;EAAlB,IAAwCP,aAAa,EAA3D;EAEA,MAAM;IAAEQ,cAAF;IAAkBC;EAAlB,IAA0CX,MAAM,EAAtD;EACA,MAAM,CAACY,GAAD,EAAMC,MAAN,IAAgBjB,QAAQ,EAA9B;EAEAE,SAAS,CAAC,MAAM;IACd,MAAMgB,aAAa,GAAIC,GAAD,IAAc;MAClC,MAAMC,MAA2B,GAAG,CAAC,CAAC,EAAF,EAAM,CAAC,EAAP,CAApC;MAEA,MAAMC,YAAY,GAAG,IAAIlB,QAAQ,CAACK,GAAb,CAAiB;QACpCc,SAAS,EAAEH,GAAG,CAACI,OADqB;QAEpCC,KAAK,EAAE,iCAF6B;QAGpCJ,MAAM,EAAEA,MAH4B;QAIpCK,IAAI,EAAE;MAJ8B,CAAjB,CAArB;MAOAJ,YAAY,CAACK,EAAb,CAAgB,OAAhB,EAA0BC,CAAD,IAAO;QAC9B,MAAMC,IAAI,GAAG,CACX,CAACD,CAAC,CAACE,KAAF,CAAQC,CAAR,GAAY,CAAb,EAAgBH,CAAC,CAACE,KAAF,CAAQE,CAAR,GAAY,CAA5B,CADW,EAEX,CAACJ,CAAC,CAACE,KAAF,CAAQC,CAAR,GAAY,CAAb,EAAgBH,CAAC,CAACE,KAAF,CAAQE,CAAR,GAAY,CAA5B,CAFW,CAAb,CAD8B,CAM9B;;QACA,MAAMC,eAAe,GAAGX,YAAY,CAACY,qBAAb,CAAmCL,IAAnC,EAAyC;UAC/DM,MAAM,EAAE,CAAC,eAAD;QADuD,CAAzC,CAAxB;QAIA,MAAMT,IAAI,GAAGJ,YAAY,CAACc,OAAb,EAAb;;QAEA,IAAIH,eAAe,CAACI,MAAhB,KAA2B,CAA3B,IAAgCX,IAAI,GAAG,CAA3C,EAA8C;UAC5CV,mBAAmB;QACpB,CAFD,MAEO,IAAIiB,eAAe,CAACI,MAAhB,KAA2B,CAA/B,EAAkC;UACvCtB,cAAc;QACf;MACF,CAlBD;MAoBAG,MAAM,CAACI,YAAD,CAAN;IACD,CA/BD;;IAiCA,IAAI,CAACL,GAAL,EAAU;MACRE,aAAa,CAACT,YAAD,CAAb;IACD,CAFD,MAEO;MACL,IAAI,CAACC,iBAAL,EAAwB;QACtBC,oBAAoB,CAACK,GAAD,CAApB;MACD;;MAED,IAAI,CAACJ,cAAL,EAAqB;QACnBC,iBAAiB,CAACG,GAAD,CAAjB;MACD;IACF;EACF,CA7CQ,EA6CN,CAACA,GAAD,CA7CM,CAAT;EA+CA,oBAAO;IAAK,EAAE,EAAC,KAAR;IAAc,GAAG,EAAGqB,EAAD,IAAS5B,YAAY,CAACc,OAAb,GAAuBc,EAAnD;IAAwD,SAAS,EAAC;EAAlE;IAAA;IAAA;IAAA;EAAA,QAAP;AACD,CA3DD;;GAAM7B,G;UAKgDH,gB,EACNC,a,EAEEF,M;;;KAR5CI,G;AA6DN,eAAeA,GAAf"},"metadata":{},"sourceType":"module"}