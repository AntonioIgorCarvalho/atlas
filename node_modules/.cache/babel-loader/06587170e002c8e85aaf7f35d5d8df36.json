{"ast":null,"code":"import * as turf from '@turf/turf';\nimport { hoveredPopup, clickedPopup } from '../../const';\nimport geosesData from '@data/Data.json';\nimport { formatPopulationNumber } from '@utils/formatValue';\nlet clickedId;\nlet hoveredId;\n\nfunction setFeatureClick(featureID, map, state) {\n  map.setFeatureState({\n    source: 'district',\n    id: featureID\n  }, {\n    click: state\n  });\n}\n\nfunction setFeatureHover(featureID, map, state) {\n  map.setFeatureState({\n    source: 'district',\n    id: featureID\n  }, {\n    hover: state\n  });\n}\n\nexport function addHoverPopup(feature, map) {\n  var _feature$features$, _feature$features$$pr;\n\n  const coordinates = feature.lngLat;\n  const regionName = (_feature$features$ = feature.features[0]) === null || _feature$features$ === void 0 ? void 0 : (_feature$features$$pr = _feature$features$.properties) === null || _feature$features$$pr === void 0 ? void 0 : _feature$features$$pr.NM_MUN;\n  hoveredPopup.setLngLat(coordinates).setHTML(`<div style=\"display: flex;flex-direction: column;\"><h5>${regionName}</h5></div>`);\n  hoveredPopup.addTo(map);\n}\nexport function addClickPopup(feature, map, lngLat, type) {\n  var _feature$features$2, _feature$features$2$p, _feature$features$3, _feature$features$3$p, _feature$features$4, _feature$features$4$p;\n\n  const coordinates = feature.lngLat;\n  const regionName = (_feature$features$2 = feature.features[0]) === null || _feature$features$2 === void 0 ? void 0 : (_feature$features$2$p = _feature$features$2.properties) === null || _feature$features$2$p === void 0 ? void 0 : _feature$features$2$p.NM_MUN;\n  const population = //@ts-ignore\n  ((_feature$features$3 = feature.features[0]) === null || _feature$features$3 === void 0 ? void 0 : (_feature$features$3$p = _feature$features$3.properties) === null || _feature$features$3$p === void 0 ? void 0 : _feature$features$3$p.CD_MUN) != undefined //@ts-ignore\n  ? geosesData[(_feature$features$4 = feature.features[0]) === null || _feature$features$4 === void 0 ? void 0 : (_feature$features$4$p = _feature$features$4.properties) === null || _feature$features$4$p === void 0 ? void 0 : _feature$features$4$p.CD_MUN]['Populacao_Estimada'] : '';\n  clickedPopup.setLngLat(coordinates).setHTML(`<div style=\"display: flex; flex-direction: column; cursor: default;\n          pointer-events: all;\"><h5>${regionName}</h5><h5>População: ${formatPopulationNumber(population)}</h5></div>`);\n  clickedPopup.addTo(map);\n}\nexport function clickDistrict(feature, map) {\n  const districtID = feature === null || feature === void 0 ? void 0 : feature.properties.CD_MUN;\n\n  if (feature && feature.geometry && districtID) {\n    if (districtID === clickedId) {\n      return;\n    }\n\n    setFeatureClick(districtID, map, true);\n\n    if (clickedId) {\n      setFeatureClick(clickedId, map, false);\n    }\n\n    clickedId = districtID;\n  } else {\n    clickedPopup.remove();\n\n    if (clickedId !== undefined) {\n      if (map.getSource('district')) {\n        setFeatureClick(clickedId, map, false);\n      }\n\n      clickedId = 0;\n    }\n  }\n}\nexport function highlightDistrict(feature, map) {\n  const districtID = feature === null || feature === void 0 ? void 0 : feature.properties.CD_MUN;\n\n  if (feature && feature.geometry && districtID) {\n    if (districtID === hoveredId) {\n      return;\n    }\n\n    if (hoveredId) {\n      setFeatureHover(hoveredId, map, false);\n    }\n\n    setFeatureHover(districtID, map, true);\n    hoveredId = districtID;\n  } else if (hoveredId) {\n    hoveredPopup.remove();\n\n    if (map.getSource('district')) {\n      setFeatureHover(hoveredId, map, false);\n    }\n\n    hoveredId = undefined;\n  }\n}\nexport function isDistrictLayerVisible(map, visible) {\n  const visibility = visible ? 'visible' : 'none';\n\n  if (map.getLayer('fill-district')) {\n    map.setLayoutProperty('fill-district', 'visibility', visibility);\n  }\n\n  if (map.getLayer('district-borders')) {\n    map.setLayoutProperty('district-borders', 'visibility', visibility);\n  }\n}\nexport function cleanDistrictActions() {\n  hoveredPopup.remove();\n  clickedPopup.remove();\n  clickedId = 0;\n  hoveredId = undefined;\n}\nexport function fitDistrictBounds(feature, map) {\n  if (feature && (feature.geometry || feature._geometry)) {\n    const [minX, minY, maxX, maxY] = turf.bbox(feature);\n    map.fitBounds([[minX, minY], [maxX, maxY]], {\n      padding: {\n        top: 200,\n        bottom: 200,\n        left: 550,\n        right: 200\n      }\n    });\n  }\n}","map":{"version":3,"names":["turf","hoveredPopup","clickedPopup","geosesData","formatPopulationNumber","clickedId","hoveredId","setFeatureClick","featureID","map","state","setFeatureState","source","id","click","setFeatureHover","hover","addHoverPopup","feature","coordinates","lngLat","regionName","features","properties","NM_MUN","setLngLat","setHTML","addTo","addClickPopup","type","population","CD_MUN","undefined","clickDistrict","districtID","geometry","remove","getSource","highlightDistrict","isDistrictLayerVisible","visible","visibility","getLayer","setLayoutProperty","cleanDistrictActions","fitDistrictBounds","_geometry","minX","minY","maxX","maxY","bbox","fitBounds","padding","top","bottom","left","right"],"sources":["/Users/leonardogomes/Documents/atlas/atlas/src/components/Map/hook/useDistrictLayer/districtActions.ts"],"sourcesContent":["import * as turf from '@turf/turf';\nimport mapboxgl from 'mapbox-gl';\n\nimport { District } from '@customTypes/feature';\n\nimport { hoveredPopup, clickedPopup } from '../../const';\n\nimport geosesData from '@data/Data.json';\nimport { formatPopulationNumber } from '@utils/formatValue';\nimport { MapActionType } from '@customTypes/mapProps';\n\nlet clickedId: number | undefined;\nlet hoveredId: number | undefined;\n\ntype Feature = District | null;\n\nfunction setFeatureClick(featureID: number, map: mapboxgl.Map, state: boolean) {\n  map.setFeatureState({ source: 'district', id: featureID }, { click: state });\n}\n\nfunction setFeatureHover(featureID: number, map: mapboxgl.Map, state: boolean) {\n  map.setFeatureState({ source: 'district', id: featureID }, { hover: state });\n}\n\nexport function addHoverPopup(feature: mapboxgl.EventData, map: mapboxgl.Map) {\n  const coordinates = feature.lngLat;\n  const regionName = feature.features[0]?.properties?.NM_MUN;\n\n  hoveredPopup\n    .setLngLat(coordinates)\n    .setHTML(`<div style=\"display: flex;flex-direction: column;\"><h5>${regionName}</h5></div>`);\n\n  hoveredPopup.addTo(map);\n}\n\nexport function addClickPopup(\n  feature: mapboxgl.EventData,\n  map: mapboxgl.Map,\n  lngLat: mapboxgl.LngLat,\n  type: MapActionType,\n) {\n  const coordinates = feature.lngLat;\n  const regionName = feature.features[0]?.properties?.NM_MUN;\n  const population =\n    //@ts-ignore\n    feature.features[0]?.properties?.CD_MUN != undefined //@ts-ignore\n      ? geosesData[feature.features[0]?.properties?.CD_MUN]['Populacao_Estimada']\n      : '';\n\n  clickedPopup.setLngLat(coordinates).setHTML(\n    `<div style=\"display: flex; flex-direction: column; cursor: default;\n          pointer-events: all;\"><h5>${regionName}</h5><h5>População: ${formatPopulationNumber(population)}</h5></div>`,\n  );\n\n  clickedPopup.addTo(map);\n}\n\nexport function clickDistrict(feature: Feature, map: mapboxgl.Map) {\n  const districtID = feature?.properties.CD_MUN;\n\n  if (feature && feature.geometry && districtID) {\n    if (districtID === clickedId) {\n      return;\n    }\n\n    setFeatureClick(districtID, map, true);\n\n    if (clickedId) {\n      setFeatureClick(clickedId, map, false);\n    }\n\n    clickedId = districtID;\n  } else {\n    clickedPopup.remove();\n\n    if (clickedId !== undefined) {\n      if (map.getSource('district')) {\n        setFeatureClick(clickedId, map, false);\n      }\n      clickedId = 0;\n    }\n  }\n}\n\nexport function highlightDistrict(feature: Feature, map: mapboxgl.Map) {\n  const districtID = feature?.properties.CD_MUN;\n\n  if (feature && feature.geometry && districtID) {\n    if (districtID === hoveredId) {\n      return;\n    }\n\n    if (hoveredId) {\n      setFeatureHover(hoveredId, map, false);\n    }\n\n    setFeatureHover(districtID, map, true);\n    hoveredId = districtID;\n  } else if (hoveredId) {\n    hoveredPopup.remove();\n\n    if (map.getSource('district')) {\n      setFeatureHover(hoveredId, map, false);\n    }\n    hoveredId = undefined;\n  }\n}\n\nexport function isDistrictLayerVisible(map: mapboxgl.Map, visible: boolean) {\n  const visibility = visible ? 'visible' : 'none';\n\n  if (map.getLayer('fill-district')) {\n    map.setLayoutProperty('fill-district', 'visibility', visibility);\n  }\n\n  if (map.getLayer('district-borders')) {\n    map.setLayoutProperty('district-borders', 'visibility', visibility);\n  }\n}\n\nexport function cleanDistrictActions() {\n  hoveredPopup.remove();\n  clickedPopup.remove();\n  clickedId = 0;\n  hoveredId = undefined;\n}\n\nexport function fitDistrictBounds(feature: Feature, map: mapboxgl.Map) {\n  if (feature && (feature.geometry || feature._geometry)) {\n    const [minX, minY, maxX, maxY] = turf.bbox(feature);\n\n    map.fitBounds(\n      [\n        [minX, minY],\n        [maxX, maxY],\n      ],\n      {\n        padding: { top: 200, bottom: 200, left: 550, right: 200 },\n      },\n    );\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}