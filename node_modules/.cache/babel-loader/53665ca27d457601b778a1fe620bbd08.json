{"ast":null,"code":"import _slicedToArray from\"/Users/leonardogomes/Documents/atlas/atlas/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import*as turf from'@turf/turf';import{hoveredPopup,clickedPopup}from'../../const';import geosesData from'@data/Data.json';import{formatPopulationNumber}from'@utils/formatValue';var clickedId;var hoveredId;function setFeatureClick(featureID,map,state){map.setFeatureState({source:'district',id:featureID},{click:state});}function setFeatureHover(featureID,map,state){map.setFeatureState({source:'district',id:featureID},{hover:state});}export function addHoverPopup(feature,map){var _feature$features$,_feature$features$$pr;var coordinates=feature.lngLat;var regionName=(_feature$features$=feature.features[0])===null||_feature$features$===void 0?void 0:(_feature$features$$pr=_feature$features$.properties)===null||_feature$features$$pr===void 0?void 0:_feature$features$$pr.NM_MUN;hoveredPopup.setLngLat(coordinates).setHTML(\"<div style=\\\"display: flex;flex-direction: column;\\\"><h5>\".concat(regionName,\"</h5></div>\"));hoveredPopup.addTo(map);}export function addClickPopup(feature,map){var _feature$features$2,_feature$features$2$p,_feature$features$3,_feature$features$3$p,_feature$features$4,_feature$features$4$p;var coordinates=feature.lngLat;var regionName=(_feature$features$2=feature.features[0])===null||_feature$features$2===void 0?void 0:(_feature$features$2$p=_feature$features$2.properties)===null||_feature$features$2$p===void 0?void 0:_feature$features$2$p.NM_MUN;var population=//@ts-ignore\n((_feature$features$3=feature.features[0])===null||_feature$features$3===void 0?void 0:(_feature$features$3$p=_feature$features$3.properties)===null||_feature$features$3$p===void 0?void 0:_feature$features$3$p.CD_MUN)!=undefined//@ts-ignore\n?geosesData[(_feature$features$4=feature.features[0])===null||_feature$features$4===void 0?void 0:(_feature$features$4$p=_feature$features$4.properties)===null||_feature$features$4$p===void 0?void 0:_feature$features$4$p.CD_MUN]['Populacao_Estimada']:'';clickedPopup.setLngLat(coordinates).setHTML(\"<div style=\\\"display: flex; flex-direction: column; cursor: default;\\n          pointer-events: all;\\\"><h5>\".concat(regionName,\"</h5><h5>Popula\\xE7\\xE3o: \").concat(formatPopulationNumber(population),\"</h5></div>\"));clickedPopup.addTo(map);}export function clickDistrict(feature,map){var districtID=feature===null||feature===void 0?void 0:feature.properties.CD_MUN;if(feature&&feature.geometry&&districtID){if(districtID===clickedId){return;}setFeatureClick(districtID,map,true);if(clickedId){setFeatureClick(clickedId,map,false);}clickedId=districtID;}else{clickedPopup.remove();if(clickedId!==undefined){if(map.getSource('district')){setFeatureClick(clickedId,map,false);}clickedId=0;}}}export function highlightDistrict(feature,map){var districtID=feature===null||feature===void 0?void 0:feature.properties.CD_MUN;if(feature&&feature.geometry&&districtID){if(districtID===hoveredId){return;}if(hoveredId){setFeatureHover(hoveredId,map,false);}setFeatureHover(districtID,map,true);hoveredId=districtID;}else if(hoveredId){hoveredPopup.remove();if(map.getSource('district')){setFeatureHover(hoveredId,map,false);}hoveredId=undefined;}}export function isDistrictLayerVisible(map,visible){var visibility=visible?'visible':'none';if(map.getLayer('fill-district')){map.setLayoutProperty('fill-district','visibility',visibility);}if(map.getLayer('district-borders')){map.setLayoutProperty('district-borders','visibility',visibility);}}export function cleanDistrictActions(){hoveredPopup.remove();clickedPopup.remove();clickedId=0;hoveredId=undefined;}export function fitDistrictBounds(feature,map){if(feature&&(feature.geometry||feature._geometry)){var _turf$bbox=turf.bbox(feature),_turf$bbox2=_slicedToArray(_turf$bbox,4),minX=_turf$bbox2[0],minY=_turf$bbox2[1],maxX=_turf$bbox2[2],maxY=_turf$bbox2[3];map.fitBounds([[minX,minY],[maxX,maxY]],{padding:{top:200,bottom:200,left:550,right:200}});}}","map":{"version":3,"names":["turf","hoveredPopup","clickedPopup","geosesData","formatPopulationNumber","clickedId","hoveredId","setFeatureClick","featureID","map","state","setFeatureState","source","id","click","setFeatureHover","hover","addHoverPopup","feature","coordinates","lngLat","regionName","features","properties","NM_MUN","setLngLat","setHTML","addTo","addClickPopup","population","CD_MUN","undefined","clickDistrict","districtID","geometry","remove","getSource","highlightDistrict","isDistrictLayerVisible","visible","visibility","getLayer","setLayoutProperty","cleanDistrictActions","fitDistrictBounds","_geometry","bbox","minX","minY","maxX","maxY","fitBounds","padding","top","bottom","left","right"],"sources":["/Users/leonardogomes/Documents/atlas/atlas/src/components/Map/hook/useDistrictLayer/districtActions.ts"],"sourcesContent":["import * as turf from '@turf/turf';\nimport mapboxgl from 'mapbox-gl';\n\nimport { District } from '@customTypes/feature';\n\nimport { hoveredPopup, clickedPopup } from '../../const';\n\nimport geosesData from '@data/Data.json';\nimport { formatPopulationNumber } from '@utils/formatValue';\n\nlet clickedId: number | undefined;\nlet hoveredId: number | undefined;\n\ntype Feature = District | null;\n\nfunction setFeatureClick(featureID: number, map: mapboxgl.Map, state: boolean) {\n  map.setFeatureState({ source: 'district', id: featureID }, { click: state });\n}\n\nfunction setFeatureHover(featureID: number, map: mapboxgl.Map, state: boolean) {\n  map.setFeatureState({ source: 'district', id: featureID }, { hover: state });\n}\n\nexport function addHoverPopup(feature: mapboxgl.EventData, map: mapboxgl.Map) {\n  const coordinates = feature.lngLat;\n  const regionName = feature.features[0]?.properties?.NM_MUN;\n\n  hoveredPopup\n    .setLngLat(coordinates)\n    .setHTML(`<div style=\"display: flex;flex-direction: column;\"><h5>${regionName}</h5></div>`);\n\n  hoveredPopup.addTo(map);\n}\n\nexport function addClickPopup(feature: mapboxgl.EventData, map: mapboxgl.Map) {\n  const coordinates = feature.lngLat;\n  const regionName = feature.features[0]?.properties?.NM_MUN;\n  const population =\n    //@ts-ignore\n    feature.features[0]?.properties?.CD_MUN != undefined //@ts-ignore\n      ? geosesData[feature.features[0]?.properties?.CD_MUN]['Populacao_Estimada']\n      : '';\n\n  clickedPopup.setLngLat(coordinates).setHTML(\n    `<div style=\"display: flex; flex-direction: column; cursor: default;\n          pointer-events: all;\"><h5>${regionName}</h5><h5>População: ${formatPopulationNumber(population)}</h5></div>`,\n  );\n\n  clickedPopup.addTo(map);\n}\n\nexport function clickDistrict(feature: Feature, map: mapboxgl.Map) {\n  const districtID = feature?.properties.CD_MUN;\n\n  if (feature && feature.geometry && districtID) {\n    if (districtID === clickedId) {\n      return;\n    }\n\n    setFeatureClick(districtID, map, true);\n\n    if (clickedId) {\n      setFeatureClick(clickedId, map, false);\n    }\n\n    clickedId = districtID;\n  } else {\n    clickedPopup.remove();\n\n    if (clickedId !== undefined) {\n      if (map.getSource('district')) {\n        setFeatureClick(clickedId, map, false);\n      }\n      clickedId = 0;\n    }\n  }\n}\n\nexport function highlightDistrict(feature: Feature, map: mapboxgl.Map) {\n  const districtID = feature?.properties.CD_MUN;\n\n  if (feature && feature.geometry && districtID) {\n    if (districtID === hoveredId) {\n      return;\n    }\n\n    if (hoveredId) {\n      setFeatureHover(hoveredId, map, false);\n    }\n\n    setFeatureHover(districtID, map, true);\n    hoveredId = districtID;\n  } else if (hoveredId) {\n    hoveredPopup.remove();\n\n    if (map.getSource('district')) {\n      setFeatureHover(hoveredId, map, false);\n    }\n    hoveredId = undefined;\n  }\n}\n\nexport function isDistrictLayerVisible(map: mapboxgl.Map, visible: boolean) {\n  const visibility = visible ? 'visible' : 'none';\n\n  if (map.getLayer('fill-district')) {\n    map.setLayoutProperty('fill-district', 'visibility', visibility);\n  }\n\n  if (map.getLayer('district-borders')) {\n    map.setLayoutProperty('district-borders', 'visibility', visibility);\n  }\n}\n\nexport function cleanDistrictActions() {\n  hoveredPopup.remove();\n  clickedPopup.remove();\n  clickedId = 0;\n  hoveredId = undefined;\n}\n\nexport function fitDistrictBounds(feature: Feature, map: mapboxgl.Map) {\n  if (feature && (feature.geometry || feature._geometry)) {\n    const [minX, minY, maxX, maxY] = turf.bbox(feature);\n\n    map.fitBounds(\n      [\n        [minX, minY],\n        [maxX, maxY],\n      ],\n      {\n        padding: { top: 200, bottom: 200, left: 550, right: 200 },\n      },\n    );\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}