{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useEffect, useState } from 'react';\nimport { useHighlightedDistrict } from '@store/district/highlightedContext';\nimport { useSelectedDistrict } from '@store/district/selectedContext';\nimport { useSelectedState } from '@store/state/selectedContext';\nimport { useSidebar } from '@store/sidebarContext';\nimport { highlightDistrict, clickDistrict, cleanDistrictActions, fitDistrictBounds, addClickPopup, addHoverPopup } from './districtActions';\nimport { RSColors } from './const';\nimport { lineOpacity, lineWidth, fillOpacity } from '../../const';\nimport geojsonGO from '@data/states/RS_Municipios_2020.json';\nimport { fitStateBounds } from '../useStateLayer/stateActions';\nimport { findState } from '@components/Map/actions';\n\nconst useDistrictLayer = () => {\n  _s();\n\n  const [districtReference, setDistrictReference] = useState();\n  const {\n    setHighlighted: setHighlightedDistrict,\n    highlighted: highlightedDistrict\n  } = useHighlightedDistrict();\n  const {\n    setSelected: setSelectedDistrict,\n    selected: selectedDistrict\n  } = useSelectedDistrict();\n  const {\n    selected: selectedState,\n    setSelected: setSelectedState,\n    all: allState\n  } = useSelectedState();\n  const {\n    setIsSidebarOpen\n  } = useSidebar();\n\n  function initLayers(reference) {\n    reference.on('load', () => {\n      reference.dragRotate.disable();\n      reference.touchZoomRotate.disableRotation();\n      reference.addSource('district', {\n        type: 'geojson',\n        //@ts-ignore\n        data: geojsonGO,\n        //@ts-ignore\n        promoteId: 'CD_MUN'\n      });\n      reference.addLayer({\n        id: 'fill-district',\n        type: 'fill',\n        source: 'district',\n        layout: {\n          visibility: 'none'\n        },\n        paint: {\n          'fill-color': {\n            property: 'POPULATION',\n            stops: RSColors\n          },\n          //@ts-ignore\n          'fill-opacity': fillOpacity\n        }\n      });\n      reference.addLayer({\n        id: 'district-borders',\n        type: 'line',\n        source: 'district',\n        layout: {\n          visibility: 'none'\n        },\n        paint: {\n          'line-color': '#ffffff',\n          //@ts-ignore\n          'line-width': lineWidth,\n          //@ts-ignore\n          'line-opacity': lineOpacity\n        }\n      });\n    });\n  }\n\n  function initActions(reference) {\n    reference.on('click', 'fill-district', e => {\n      if (e.features.length > 0) {\n        setSelectedDistrict(e.features[0]);\n      }\n\n      addClickPopup(e, reference);\n    });\n    reference.on('mousemove', 'fill-district', e => {\n      if (e.features.length > 0) {\n        setHighlightedDistrict(e.features[0]);\n      }\n\n      addHoverPopup(e, reference);\n    });\n    reference.on('mouseleave', 'fill-district', () => {\n      setHighlightedDistrict(null);\n    });\n  }\n\n  useEffect(() => {\n    if (districtReference) {\n      initLayers(districtReference);\n      initActions(districtReference);\n    }\n  }, [districtReference]);\n  useEffect(() => {\n    if (districtReference) {\n      highlightDistrict(highlightedDistrict, districtReference);\n    }\n  }, [highlightedDistrict]);\n  useEffect(() => {\n    if (districtReference && selectedDistrict !== null) {\n      console.log(selectedDistrict);\n\n      if (selectedState === null) {\n        const state = findState(allState, selectedDistrict.properties.SIGLA_UF);\n        setSelectedState(state);\n      } else {\n        setSelectedState(null);\n      }\n\n      clickDistrict(selectedDistrict, districtReference);\n      fitDistrictBounds(selectedDistrict, districtReference);\n      setIsSidebarOpen(true);\n    } else if (districtReference) {\n      clickDistrict(null, districtReference);\n      fitStateBounds(selectedState, districtReference);\n      cleanDistrictActions();\n    }\n  }, [selectedDistrict]);\n  return {\n    districtReference,\n    setDistrictReference\n  };\n};\n\n_s(useDistrictLayer, \"7ZThlZ8G5yYNJyBH/sH9H9DsSos=\", false, function () {\n  return [useHighlightedDistrict, useSelectedDistrict, useSelectedState, useSidebar];\n});\n\nexport default useDistrictLayer;","map":{"version":3,"names":["useEffect","useState","useHighlightedDistrict","useSelectedDistrict","useSelectedState","useSidebar","highlightDistrict","clickDistrict","cleanDistrictActions","fitDistrictBounds","addClickPopup","addHoverPopup","RSColors","lineOpacity","lineWidth","fillOpacity","geojsonGO","fitStateBounds","findState","useDistrictLayer","districtReference","setDistrictReference","setHighlighted","setHighlightedDistrict","highlighted","highlightedDistrict","setSelected","setSelectedDistrict","selected","selectedDistrict","selectedState","setSelectedState","all","allState","setIsSidebarOpen","initLayers","reference","on","dragRotate","disable","touchZoomRotate","disableRotation","addSource","type","data","promoteId","addLayer","id","source","layout","visibility","paint","property","stops","initActions","e","features","length","console","log","state","properties","SIGLA_UF"],"sources":["/Users/leonardogomes/Documents/atlas/atlas/src/components/Map/hook/useDistrictLayer/useDistrictLayer.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\n\nimport mapboxgl from 'mapbox-gl';\n\nimport { useHighlightedDistrict } from '@store/district/highlightedContext';\nimport { useSelectedDistrict } from '@store/district/selectedContext';\nimport { useSelectedState } from '@store/state/selectedContext';\nimport { useSidebar } from '@store/sidebarContext';\n\nimport {\n  highlightDistrict,\n  clickDistrict,\n  cleanDistrictActions,\n  fitDistrictBounds,\n  addClickPopup,\n  addHoverPopup,\n} from './districtActions';\n\nimport { RSColors } from './const';\nimport { lineOpacity, lineWidth, fillOpacity } from '../../const';\n\nimport geojsonGO from '@data/states/RS_Municipios_2020.json';\nimport { fitStateBounds } from '../useStateLayer/stateActions';\nimport { findState } from '@components/Map/actions';\n\nconst useDistrictLayer = () => {\n  const [districtReference, setDistrictReference] = useState<mapboxgl.Map>();\n\n  const { setHighlighted: setHighlightedDistrict, highlighted: highlightedDistrict } = useHighlightedDistrict();\n  const { setSelected: setSelectedDistrict, selected: selectedDistrict } = useSelectedDistrict();\n\n  const { selected: selectedState, setSelected: setSelectedState, all: allState } = useSelectedState();\n\n  const { setIsSidebarOpen } = useSidebar();\n\n  function initLayers(reference: mapboxgl.Map) {\n    reference.on('load', () => {\n      reference.dragRotate.disable();\n      reference.touchZoomRotate.disableRotation();\n\n      reference.addSource('district', {\n        type: 'geojson',\n        //@ts-ignore\n        data: geojsonGO,\n        //@ts-ignore\n        promoteId: 'CD_MUN',\n      });\n\n      reference.addLayer({\n        id: 'fill-district',\n        type: 'fill',\n        source: 'district',\n        layout: {\n          visibility: 'none',\n        },\n        paint: {\n          'fill-color': {\n            property: 'POPULATION',\n            stops: RSColors,\n          },\n          //@ts-ignore\n          'fill-opacity': fillOpacity,\n        },\n      });\n\n      reference.addLayer({\n        id: 'district-borders',\n        type: 'line',\n        source: 'district',\n        layout: {\n          visibility: 'none',\n        },\n        paint: {\n          'line-color': '#ffffff',\n          //@ts-ignore\n          'line-width': lineWidth,\n          //@ts-ignore\n          'line-opacity': lineOpacity,\n        },\n      });\n    });\n  }\n\n  function initActions(reference: mapboxgl.Map) {\n    reference.on('click', 'fill-district', (e: mapboxgl.EventData) => {\n      if (e.features.length > 0) {\n        setSelectedDistrict(e.features[0]);\n      }\n\n      addClickPopup(e, reference);\n    });\n\n    reference.on('mousemove', 'fill-district', (e: mapboxgl.EventData) => {\n      if (e.features.length > 0) {\n        setHighlightedDistrict(e.features[0]);\n      }\n\n      addHoverPopup(e, reference);\n    });\n\n    reference.on('mouseleave', 'fill-district', () => {\n      setHighlightedDistrict(null);\n    });\n  }\n\n  useEffect(() => {\n    if (districtReference) {\n      initLayers(districtReference);\n      initActions(districtReference);\n    }\n  }, [districtReference]);\n\n  useEffect(() => {\n    if (districtReference) {\n      highlightDistrict(highlightedDistrict, districtReference);\n    }\n  }, [highlightedDistrict]);\n\n  useEffect(() => {\n    if (districtReference && selectedDistrict !== null) {\n      console.log(selectedDistrict);\n\n      if (selectedState === null) {\n        const state = findState(allState, selectedDistrict.properties.SIGLA_UF);\n\n        setSelectedState(state);\n      } else {\n        setSelectedState(null);\n      }\n\n      clickDistrict(selectedDistrict, districtReference);\n\n      fitDistrictBounds(selectedDistrict, districtReference);\n\n      setIsSidebarOpen(true);\n    } else if (districtReference) {\n      clickDistrict(null, districtReference);\n\n      fitStateBounds(selectedState, districtReference);\n\n      cleanDistrictActions();\n    }\n  }, [selectedDistrict]);\n\n  return { districtReference, setDistrictReference };\n};\n\nexport default useDistrictLayer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}